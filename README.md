# üõ°Ô∏è Debian 11 CIS Hardening (Ansible)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **Ansible Playbook**, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏–∑ **CIS Benchmark for Debian 11**.  
–¶–µ–ª—å ‚Äî –ø–æ–≤—ã—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø—É—Ç—ë–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª—É–∂–±, —Å–µ—Ç–∏, –∞—É–¥–∏—Ç–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º.

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏ CIS

### üîπ 2.x ‚Äî –°–µ—Ä–≤–∏—Å—ã –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏
- **2.1.1.1** ‚Äî –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Chrony –∏ —É–¥–∞–ª—è–µ—Ç –¥—Ä—É–≥–∏–µ –¥–µ–º–æ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏ (ntp, systemd-timesyncd), —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω.  
- **2.1.2.1** ‚Äî –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç Chrony —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (NTP-–ø—É–ª—ã Debian).  
- **2.1.2.2** ‚Äî –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ Chrony –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `_chrony` –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.  
- **2.1.2.3** ‚Äî –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–ª—É–∂–±–∞ Chrony –≤–∫–ª—é—á–µ–Ω–∞ –∏ –∑–∞–ø—É—â–µ–Ω–∞.  
- **2.1.3.0** ‚Äî –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–∞–∫–µ—Ç `systemd-timesyncd`.  
- **2.1.3.1** ‚Äî –°–æ–∑–¥–∞—ë—Ç –∫–∞—Ç–∞–ª–æ–≥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è systemd-timesyncd –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ NTP-—Å–µ—Ä–≤–µ—Ä—ã (Ubuntu, Google, Cloudflare).  
- **2.1.3.2** ‚Äî –í–∫–ª—é—á–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª—É–∂–±—É systemd-timesyncd.  
- **2.2.1** ‚Äî –£–¥–∞–ª—è–µ—Ç X Window System (xserver-xorg*).  
- **2.3.1** ‚Äî –£–¥–∞–ª—è–µ—Ç NIS Client.  
- **2.3.2** ‚Äî –£–¥–∞–ª—è–µ—Ç rsh-client.  
- **2.3.3** ‚Äî –£–¥–∞–ª—è–µ—Ç talk.  
- **2.3.5** ‚Äî –£–¥–∞–ª—è–µ—Ç ldap-utils, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç LDAP –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.  
- **2.4** ‚Äî –í—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É–¥–∏—Ç –ø—Ä–æ—Å–ª—É—à–∏–≤–∞—é—â–∏—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å–ª—É–∂–± –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `/root/nonessential_services_audit.txt`.  

---

### üîπ 3.x ‚Äî –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä

- **3.1.1** ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç IPv6 —á–µ—Ä–µ–∑ GRUB (`ipv6.disable=1`).  
- **3.1.2** ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (Wi-Fi).  
- **3.1.3‚Äì3.1.6** ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç –º–æ–¥—É–ª–∏ —è–¥—Ä–∞: dccp, sctp, rds, tipc.  
- **3.2.1** ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É ICMP redirect-–ø–∞–∫–µ—Ç–æ–≤ (`send_redirects=0`).  
- **3.2.2** ‚Äî –û—Ç–∫–ª—é—á–∞–µ—Ç IP-–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (IPv4 –∏ IPv6).  
- **3.3.1‚Äì3.3.3** ‚Äî –ó–∞–ø—Ä–µ—â–∞–µ—Ç –ø—Ä–∏—ë–º source-routed –∏ ICMP redirect –ø–∞–∫–µ—Ç–æ–≤.  
- **3.3.4** ‚Äî –í–∫–ª—é—á–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ (`log_martians=1`).  
- **3.3.5‚Äì3.3.8** ‚Äî –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ ICMP-–ø–∞–∫–µ—Ç—ã, –≤–∫–ª—é—á–∞–µ—Ç Reverse Path Filtering –∏ TCP SYN Cookies.  
- **3.3.9** ‚Äî –ó–∞–ø—Ä–µ—â–∞–µ—Ç –ø—Ä–∏—ë–º IPv6 router advertisements.  
- **3.5.1.1‚Äì3.5.1.7** ‚Äî –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç UFW:  
  - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç `ufw`,  
  - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç SSH,  
  - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç loopback-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å,  
  - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∏—Å—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è,  
  - –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞—É–¥–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤,  
  - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫—É `deny` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.  

---

### üîπ 4.x ‚Äî –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- **4.1.1.1‚Äì4.1.1.2** ‚Äî –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç `auditd` –∏ `audispd-plugins`.  
- **4.1.1.3‚Äì4.1.1.4** ‚Äî –í–∫–ª—é—á–∞–µ—Ç –∞—É–¥–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–æ –∑–∞–ø—É—Å–∫–∞ auditd, –∑–∞–¥–∞—ë—Ç `audit_backlog_limit=8192`.  
- **4.1.2.1‚Äì4.1.2.2** ‚Äî –ó–∞–¥–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ –∏ –∑–∞–ø—Ä–µ—â–∞–µ—Ç –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ (`keep_logs`).  
- **4.1.3.1‚Äì4.1.3.20** ‚Äî –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ –∞—É–¥–∏—Ç–∞:
  - –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `/etc/sudoers`, `/etc/passwd`, `/etc/group`;  
  - –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ `sudo` –∏ `su`;  
  - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, hostname –∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤;  
  - –∑–∞–ø—É—Å–∫ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–∞–Ω–¥;  
  - –Ω–µ—É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞;  
  - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ (`delete`, `rename`);  
  - –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º;  
  - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞;  
  - —Ñ–∏–∫—Å–∞—Ü–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞.  
  - –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∞—É–¥–∏—Ç–∞ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π (`-e 2`).  
- **4.1.4.1‚Äì4.1.4.10** ‚Äî –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –∏ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –¥–ª—è —Ñ–∞–π–ª–æ–≤ –∞—É–¥–∏—Ç–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (`0640`, `root:root`).  
- **4.2.x** ‚Äî –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç `journald`, `rsyslog`, `systemd-journal-remote`, –∑–∞–¥–∞—ë—Ç –ø—Ä–∞–≤–∞ –¥–ª—è –ª–æ–≥–æ–≤ –≤ `/var/log/`.  

---

## üß∞ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
ansible-playbook -i "localhost," /root/debian11/main.yml
