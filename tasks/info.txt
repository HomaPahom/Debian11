# 2.1.1.1 — Устанавливает Chrony и удаляет другие демоны времени (ntp, systemd-timesyncd), чтобы работал только один.
# 2.1.2.1 — Настраивает Chrony с доверенными серверами синхронизации (NTP-пулы Debian).
# 2.1.2.2 — Настраивает запуск Chrony от имени пользователя _chrony для повышения безопасности.
# 2.1.2.3 — Проверяет, что служба Chrony включена и запущена.
# 2.1.3.0 — Устанавливает пакет systemd-timesyncd.
# 2.1.3.1 — Создаёт каталог конфигурации для systemd-timesyncd и прописывает авторизованные NTP-серверы (Ubuntu, Google, Cloudflare).
# 2.1.3.2 — Включает и запускает службу systemd-timesyncd.
# 2.2.1 — Удаляет X Window System (xserver-xorg*), чтобы исключить ненужную графическую подсистему на сервере.
# 2.3.1 — Удаляет NIS Client, устаревший сервис сетевой аутентификации.
# 2.3.2 — Удаляет rsh-client, небезопасный нешифрованный удалённый shell.
# 2.3.3 — Удаляет talk, старую утилиту для сетевого общения.
# 2.3.5 — Удаляет ldap-utils, если клиент LDAP не требуется.
# 2.4 — Выполняет аудит прослушивающих сетевых служб и сохраняет результаты в /root/nonessential_services_audit.txt.
#3.1.1 — Отключает IPv6 через GRUB (добавляет ipv6.disable=1)
#3.1.2 — Отключает беспроводные интерфейсы (Wi-Fi)
#3.1.3 — Отключает модуль ядра dccp
#3.1.4 — Отключает модуль ядра sctp
#3.1.5 — Отключает модуль ядра rds
#3.1.6 — Отключает модуль ядра tipc

#3.2.1 — Отключает отправку ICMP redirect-пакетов (send_redirects=0)
#3.2.2 — Отключает IP-перенаправление (IP forwarding) для IPv4 и IPv6

#3.3.1 — Запрещает принимать source-routed пакеты (IPv4 и IPv6)
#3.3.2 — Запрещает принимать ICMP redirects (IPv4 и IPv6)
#3.3.3 — Запрещает принимать secure ICMP redirects
#3.3.4 — Включает логирование подозрительных пакетов (log_martians=1)
#3.3.5 — Игнорирует ICMP широковещательные запросы
#3.3.6 — Игнорирует ложные ICMP ответы
#3.3.7 — Включает фильтрацию обратного пути (Reverse Path Filtering)
#3.3.8 — Включает защиту TCP SYN Cookies (анти-DDoS на уровне TCP)
#3.3.9 — Запрещает принимать IPv6 router advertisements

#3.5.1.1 — Устанавливает пакет ufw (Uncomplicated Firewall)
#3.5.1.2 — Удаляет iptables-persistent, если установлен (во избежание конфликта)
#3.5.1.3 — Включает и запускает UFW, разрешает SSH
#3.5.1.4 — Настраивает loopback-интерфейс (разрешает localhost, блокирует поддельные адреса)
#3.5.1.5 — Разрешает все исходящие соединения по умолчанию
#3.5.1.6 — Аудит открытых портов и правил UFW (выводит отчёт)
#3.5.1.7 — Устанавливает политику deny по умолчанию для incoming/outgoing/routed#4.1.1.1 — Устанавливает пакеты auditd и audispd-plugins
#4.1.1.2 — Включает и запускает службу auditd
#4.1.1.3 — Включает аудит для процессов, запускающихся до старта auditd
#4.1.1.4 — Устанавливает параметр audit_backlog_limit=8192 в загрузчике (GRUB)

#4.1.2.1 — Задает максимальный размер файла аудита (max_log_file = 20)
#4.1.2.2 — Запрещает автоматическое удаление логов (keep_logs)
sd`
#4.1.3.1 — Аудит изменений в /etc/sudoers
#4.1.3.2 — Аудит действий пользователей через sudo или su
#4.1.3.3 — Аудит изменений в логе sudo.log
#4.1.3.4 — Аудит изменений времени и даты
#4.1.3.5 — Аудит изменений сетевых параметров (hostname, domainname, /etc/hosts)
#4.1.3.6 — Аудит использования привилегированных команд
#4.1.3.7 — Аудит неуспешных попыток доступа к файлам
#4.1.3.8 — Аудит изменений пользователей и групп (/etc/passwd, /etc/group)
#4.1.3.9 — Аудит изменений прав доступа к файлам (DAC permissions)
#4.1.3.10 — Аудит операций монтирования файловых систем
#4.1.3.11 — Аудит инициализации сессий (файлы utmp, wtmp, btmp)
#4.1.3.12 — Аудит событий входа/выхода пользователей
#4.1.3.13 — Аудит удаления и переименования файлов пользователями
#4.1.3.14 — Аудит изменений MAC-политик (SELinux, AppArmor)
#4.1.3.15–18 — Аудит запуска системных утилит (chcon, setfacl, usermod и др.)
#4.1.3.19 — Аудит загрузки/удаления модулей ядра
#4.1.3.20 — Делает конфигурацию аудита неизменяемой (immutable rule -e 2)

#4.1.4.1 — Определяет путь к файлу аудита
#4.1.4.1–4.1.4.3 — Устанавливает права и владельца файла аудита (root:root, 0640)
#4.1.4.4 — Задает права каталога /var/log/audit (0750)
#4.1.4.5–4.1.4.7 — Проверяет и задает права для конфигурационных файлов аудита
#4.1.4.8–4.1.4.10 — Проверяет и задает права для инструментов аудита (auditctl, ausearch и др.)


